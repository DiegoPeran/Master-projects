---
title: "Second project"
author: "Diego Perán and Katherine Fazioli"
date: "18/3/2021"
output: pdf_document
---

```{r}
library(MASS)
setwd("C:/Users/Diego/OneDrive/Documents/Master Data Science/Asignaturas3º/Simulation and Resampling/data")
data5=read.csv("data_5.csv")
head(data5)
```

**First, we bootstrap the coefficients of the complete model (with the three covariates), and with the result we extract the confidence interval of each coefficient.**


**I have used the basic confidence interval, I don't know if I should use another one, but anyway that is easy to change.**



```{r}
(theta.hat=rlm(y ~ x1 + x2 +x3,data=data5)$coef)

n=length(data5$y)
stat=function(x,xdata){rlm(xdata$y[x] ~ xdata$x1[x] + xdata$x2[x] +xdata$x3[x],data=xdata)$coef}
set.seed(1)
btheta<-bootstrap(x=1:100,nboot=5000,theta=stat,xdata=data5)$thetastar

```

```{r}
for (i in 2:4){
  print(2*theta.hat[i]-quantile(btheta[i,],c(0.975,0.025)))
}

```

\section{b)}

**we have to do backward elimination and the criteria to eliminate a covariate from the model are the estimated confidence intervals. Therefore, I first test the model by eliminating x3 since its coefficient is the lowest (I understand that this is why it is the least significant)**



```{r}

(theta.hat=rlm(y ~ x1 + x2 ,data=data5)$coef)

n=length(data5$y)
stat=function(x,xdata){rlm(xdata$y[x] ~ xdata$x1[x] + xdata$x2[x] ,data=xdata)$coef}
set.seed(1)
btheta<-bootstrap(x=1:100,nboot=5000,theta=stat,xdata=data5)$thetastar
```
```{r}
for (i in 2:3){
  print(2*theta.hat[i]-quantile(btheta[i,],c(0.975,0.025)))
}
```
**the confidence intervals of both covariates have been reduced, so I deduce that they are more reliable estimates**

**I think this model is the optimal one, but still I continue with the backward elimination, and in this case we discard x1 because it has a lower coefficient**



```{r}

(theta.hat=rlm(y ~ + x2 ,data=data5)$coef)

n=length(data5$y)
stat=function(x,xdata){rlm(xdata$y[x] ~ xdata$x2[x] ,data=xdata)$coef}
set.seed(1)
btheta<-bootstrap(x=1:100,nboot=5000,theta=stat,xdata=data5)$thetastar
```

```{r}
print(2*theta.hat[2]-quantile(btheta[2,],c(0.975,0.025)))
```

** I think the conclusion is that this model is worse, since the intercepts take a very high value and therefore the only predictor provides little information and because the confidence interval of the coefficient becomes larger **


